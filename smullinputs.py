"""
Smullyanic Dynasty utility functions.
"""

from typing import Optional, Sequence
import argparse

def parse_command(cmdline: Optional[str] = None) -> argparse.Namespace:
    """Extract command-line arguments."""
    npuzzles = 52
    parser = argparse.ArgumentParser(
        description='Solve Smullyanic Dynasty puzzle.',
        formatter_class=argparse.ArgumentDefaultsHelpFormatter)
    parser.add_argument('-v', '--verbose', help='increase output verbosity',
                        default=0, action='count')
    parser.add_argument('-r', '--report', help='report CPU time and statistics',
                        default=False, action='store_true')
    parser.add_argument('-p', '--puzzle', help='puzzle to solve',
                        type=int, choices=range(npuzzles), default=0,
                        metavar=f'{{0..{npuzzles-1}}}')
    parser.add_argument('-s', '--solutions', help='maximum number of solutions',
                        type=int, default=None)
    parser.add_argument('-m', '--matplotlib', help='output matplotlib plot',
                        default=False, action='store_true')
    parser.add_argument('-a', '--annotate', help='draw spanning tree',
                        default=False, action='store_true')
    parser.add_argument('-f', '--fontsize', help='font size for matplotlib',
                        type=int, default=24)
    parser.add_argument('-d', '--drawonly', help='draw unsolved puzzle',
                        default=False, action='store_true')
    if cmdline is None:
        return parser.parse_args()
    else:
        return parser.parse_args(cmdline.split())

def get_grid(n: int) -> tuple[tuple[Optional[int],...],...]:
    """Return description of n-th puzzle."""

    _ = None
    A = 10
    if n == 0:
        return ((_,_,_,9),
                (_,4,_,_),
                (_,_,0,_),
                (6,_,_,5))
    elif n == 1:
        return ((3,1,_,_,_),
                (_,3,_,_,_),
                (1,_,3,_,1),
                (_,_,_,2,_),
                (_,_,_,3,1))
    elif n == 2:
        return ((_,_,_,_,2,2,_,9,_),
                (_,_,3,3,_,9,_,3,_),
                (2,2,_,_,_,_,_,_,_),
                (_,_,_,3,_,_,_,_,_),
                (1,3,_,4,_,3,_,9,2),
                (_,_,_,_,_,2,_,_,_),
                (_,_,_,_,_,_,_,4,2),
                (_,9,_,1,_,2,1,_,_),
                (_,2,_,1,1,_,_,_,_))
    elif n == 3:
        return ((1,2,2,1,1),
                (2,2,1,3,2),
                (2,3,2,2,0),
                (1,3,2,3,2),
                (1,2,3,2,2))
    elif n == 4:
        return ((0,2,2,2,2,1,2,2,1,2,1,1,1,1),
                (2,1,3,2,3,2,3,2,3,3,3,1,1,2),
                (2,3,3,3,2,2,3,3,3,2,3,3,2,2),
                (1,3,1,3,3,3,3,1,3,3,2,3,2,2),
                (2,1,3,1,2,2,1,3,1,3,3,2,3,1),
                (2,3,3,3,2,3,2,4,3,2,2,2,3,2),
                (1,3,3,2,3,3,1,2,2,3,2,1,3,2),
                (2,2,2,2,2,3,3,4,3,2,2,2,3,1),
                (2,2,2,0,2,3,2,2,2,3,3,2,2,1),
                (2,3,1,0,1,2,3,4,3,3,3,3,2,1),
                (2,3,3,1,3,3,3,3,2,3,1,3,1,1),
                (2,2,3,2,3,4,3,4,3,3,3,1,3,2),
                (2,3,2,3,2,3,3,3,3,1,3,2,3,2),
                (0,2,1,2,1,2,2,2,1,2,2,2,2,1))
    elif n == 5:
        return ((3,_,_,_,2,_,_,0,_,_,3,_,_),
                (_,5,_,_,_,_,_,_,_,_,_,4,_),
                (_,1,_,3,_,3,1,3,_,_,_,_,_),
                (0,_,_,_,_,_,_,_,_,3,_,_,_),
                (_,_,_,_,_,1,3,3,_,3,_,_,0),
                (2,4,_,_,_,4,3,_,_,3,_,_,0),
                (_,_,_,0,_,3,4,3,_,1,_,_,_),
                (2,_,_,3,_,_,3,0,_,_,_,2,2),
                (2,_,_,2,_,3,4,3,_,_,_,_,_),
                (_,_,_,4,_,_,_,_,_,_,_,_,2),
                (_,_,_,_,_,3,4,3,_,3,_,0,_),
                (_,4,_,_,_,_,_,_,_,_,_,3,_),
                (_,_,2,_,_,2,_,_,2,_,_,_,2))
    elif n == 6:
        return ((1,2,2,2,1,2,2,2,2,1),
                (2,2,2,1,2,2,1,2,2,2),
                (2,1,1,1,2,1,1,1,2,1),
                (1,2,1,1,1,2,1,1,1,2),
                (1,2,2,1,1,1,1,1,2,2),
                (2,2,2,2,1,1,1,2,2,1),
                (1,1,1,1,2,2,2,2,1,2),
                (1,1,2,2,1,2,1,2,1,1),
                (1,1,2,2,2,2,1,1,1,1),
                (1,2,1,1,1,2,1,1,2,1))
    elif n == 7:
        return ((_,1,1,_,2,1,_,2,2,_),
                (1,_,_,3,_,_,4,_,_,0),
                (2,_,_,3,_,_,3,_,_,2),
                (_,3,2,_,3,3,_,2,2,_),
                (1,_,_,2,_,_,2,_,_,2),
                (1,_,_,2,_,_,2,_,_,0),
                (_,3,3,_,1,0,_,2,2,_),
                (2,_,_,3,_,_,2,_,_,1),
                (2,_,_,2,_,_,1,_,_,1),
                (_,2,1,_,2,2,_,2,1,_))
    elif n == 8:
        return ((2,_,_,_,_,_,_,_,_,1),
                (_,_,2,1,3,0,2,2,_,_),
                (_,2,1,_,_,_,_,2,2,_),
                (_,2,_,_,_,_,_,_,3,_),
                (_,1,_,_,3,3,_,_,3,_),
                (_,1,_,_,3,3,_,_,3,_),
                (_,4,_,_,_,_,_,_,2,_),
                (_,2,0,_,_,_,_,0,0,_),
                (_,_,3,3,3,1,1,1,_,_),
                (2,_,_,_,_,_,_,_,_,1))
    elif n == 9:
        return ((1,1,2,2,1),
                (2,0,3,2,2),
                (2,3,3,2,1),
                (2,3,2,2,2),
                (1,1,1,1,2))
    elif n == 10:
        return ((_,_,_,0,1,_),
                (_,3,8,_,_,_),
                (2,_,1,2,_,2),
                (2,_,1,2,_,1),
                (_,_,_,8,3,_),
                (_,2,1,_,_,_))
    elif n == 11:
        return ((1,2,0,1,_,_,3,2,1,1),
                (0,_,_,_,_,_,_,_,_,1),
                (2,_,_,9,2,_,_,_,_,2),
                (2,_,_,3,2,_,3,9,_,3),
                (_,_,_,_,_,_,2,2,_,_),
                (_,_,3,3,_,_,_,_,_,_),
                (0,_,9,1,_,2,3,_,_,3),
                (2,_,_,_,_,2,9,_,_,1),
                (0,_,_,_,_,_,_,_,_,1),
                (1,2,0,1,_,_,2,2,3,1))
    elif n == 12:
        return ((2,1,_,_,_),
                (_,_,3,_,_),
                (_,_,3,_,_),
                (_,_,3,_,_),
                (_,_,_,2,0))
    elif n == 13:
        return ((_,_,_,_,_,_,_,_,_,_),
                (_,2,2,1,2,2,3,3,1,_),
                (_,1,_,_,_,_,_,_,3,_),
                (_,2,_,2,1,2,3,_,2,_),
                (_,0,_,3,_,_,2,_,3,_),
                (_,1,_,0,_,_,1,_,2,_),
                (_,1,_,3,3,2,3,_,4,_),
                (_,3,_,_,_,_,_,_,3,_),
                (_,3,4,3,3,3,3,3,2,_),
                (_,_,_,_,_,_,_,_,_,_))
    elif n == 14:
        return ((_,2,_,3,_,_,_,_,_,_),
                (_,2,_,3,_,3,2,2,2,2),
                (_,1,_,1,_,_,_,_,_,_),
                (_,3,_,1,_,2,1,3,3,2),
                (_,2,_,2,_,_,_,_,_,_),
                (_,_,_,_,_,_,2,_,3,_),
                (2,3,3,2,3,_,2,_,1,_),
                (_,_,_,_,_,_,0,_,2,_),
                (1,2,3,2,1,_,2,_,2,_),
                (_,_,_,_,_,_,2,_,2,_))
    elif n == 15: # two solutions
        return ((4,_,0,_,5),
                (_,_,_,_,_))
    elif n == 16:
        return ((_,1,_,2,_),
                (_,_,_,3,1),
                (2,_,_,3,_),
                (_,_,_,1,_),
                (_,_,1,_,_))
    elif n == 17:
        return ((_,_,_,0,_,_,_),
                (1,2,_,0,_,1,2),
                (_,_,_,_,0,_,2),
                (1,_,_,2,_,_,_),
                (1,_,3,_,_,_,_))
    elif n == 18:
        return ((0,1,_,_,_,_,_),
                (_,_,0,_,_,_,2),
                (_,2,1,_,_,_,1),
                (1,_,_,1,1,_,2),
                (_,_,3,_,1,_,1),
                (2,_,3,_,_,2,_),
                (_,_,_,1,_,1,_))
    elif n == 19:
        return ((0,0,_,_,_,_,_,2,_),
                (_,1,_,1,_,4,_,4,_),
                (_,1,2,2,_,_,2,_,2),
                (2,_,2,_,_,_,3,_,_),
                (_,_,_,2,_,_,_,_,_),
                (2,_,4,_,3,_,3,_,_),
                (_,_,_,1,2,0,_,1,0))
    elif n == 20:
        return ((_,_,_,1,_,1,0,_),
                (_,2,_,2,_,_,_,_),
                (2,_,2,3,_,_,2,_),
                (1,_,2,3,_,3,_,0),
                (1,_,_,_,_,_,_,1),
                (_,_,_,1,2,_,2,_),
                (_,_,_,1,2,1,_,_),
                (_,_,2,_,_,_,3,2),
                (1,_,3,_,_,_,_,1),
                (2,_,_,_,2,_,_,0))
    elif n == 21:
        return ((0,_,_,_,_,2,_,_,_,_,_,0),
                (_,3,_,_,_,_,1,_,_,_,1,1),
                (_,_,_,_,2,_,2,2,3,_,_,1),
                (_,_,1,_,1,_,1,_,_,_,_,1),
                (_,_,1,2,1,_,3,2,_,1,_,0),
                (_,3,1,_,_,1,_,_,_,_,_,_),
                (1,_,2,_,_,_,_,3,3,2,_,_),
                (_,_,_,1,1,2,_,_,_,1,_,1),
                (_,_,_,_,2,2,2,_,_,_,1,_),
                (0,2,_,_,_,_,_,_,2,_,0,_),
                (2,_,1,_,2,_,1,_,_,_,1,_),
                (_,_,_,1,1,0,1,1,_,_,_,1))
    elif n == 22:
        return ((_,_,_,_,_,1,1,1,0,1),
                (_,2,2,_,_,_,_,_,_,_),
                (_,1,_,_,_,_,_,_,_,_),
                (_,4,_,_,3,_,_,0,_,_),
                (_,_,_,_,_,4,2,_,1,_),
                (_,2,_,_,2,3,_,_,0,0),
                (0,0,1,_,_,_,_,_,1,_),
                (0,_,_,_,2,0,1,_,_,_),
                (_,_,_,_,_,_,3,1,2,_),
                (_,2,_,0,1,_,_,_,_,_))
    elif n == 23:
        return ((1,_,_,2,_,_,_,0,_,_,_,_,_,1,1),
                (_,2,_,4,_,2,2,3,_,_,_,_,_,_,1),
                (_,_,_,3,_,_,_,_,_,3,_,3,4,_,_),
                (_,1,_,_,_,_,2,_,_,_,_,_,_,_,1),
                (_,_,_,_,1,2,_,_,_,0,_,_,2,2,_),
                (_,_,_,0,1,_,_,_,_,0,_,_,_,2,_),
                (_,_,1,_,_,_,1,0,0,_,_,1,_,_,_),
                (_,1,1,1,0,0,_,_,_,1,_,2,_,_,0),
                (1,_,_,_,_,_,_,2,_,2,_,4,_,1,0),
                (_,_,2,3,_,1,_,_,2,_,_,_,_,_,_),
                (2,_,2,_,_,_,_,2,_,1,_,_,_,_,_),
                (_,2,_,3,_,1,_,_,_,_,_,_,2,_,_),
                (_,_,2,_,_,1,2,_,2,_,1,1,_,_,2),
                (_,_,2,2,1,_,_,_,3,_,_,3,2,3,_),
                (1,_,0,_,_,_,_,1,_,1,_,_,1,_,_))
    elif n == 24:
        return ((_,2,_,1,0,_,_,_,_),
                (_,_,_,_,1,_,_,2,1),
                (1,3,_,_,_,_,1,_,_),
                (_,_,1,0,_,1,_,_,0),
                (1,_,_,_,_,_,_,2,_),
                (1,1,2,_,2,_,_,_,2),
                (_,_,_,2,_,_,_,4,_),
                (_,_,_,_,1,_,_,_,0),
                (2,_,1,_,0,_,_,_,_))
    elif n == 25:
        return ((1,1,_,_,1,_,_),
                (_,_,1,2,_,1,_),
                (_,1,_,1,_,_,0),
                (_,_,0,_,1,_,1),
                (_,2,_,_,1,_,_),
                (_,3,_,_,2,2,_),
                (_,2,_,3,_,_,1))
    elif n == 26:
        return ((_,_,_,1,_,_,_,0,2,_),
                (_,0,0,1,_,4,3,_,_,0),
                (_,_,1,_,2,_,3,_,_,_),
                (1,_,1,_,_,1,_,_,_,0),
                (_,2,_,_,_,_,_,_,1,0))
    elif n == 27: # no solutions
        return ((_,_,_,2,_,_,_,0,2,_),
                (_,0,0,1,_,4,3,_,_,0),
                (_,_,1,_,2,_,3,_,_,_),
                (1,_,1,_,_,1,_,_,_,0),
                (_,2,_,_,_,_,_,_,1,0))
    elif n == 28: # 6 solutions
        return ((1,1,_,_,1,_,_),
                (_,_,1,_,_,1,_),
                (_,1,_,1,_,_,0),
                (_,_,0,_,1,_,1),
                (_,2,_,_,1,_,_),
                (_,3,_,_,2,2,_),
                (_,2,_,3,_,_,1))
    elif n == 29:
        return ((_,_,_),
                (0,2,2),
                (_,1,_))
    elif n == 30:
        return ((1,_,_,_,0,_,_,_,3,_,_),
                (_,2,_,1,2,1,_,_,_,_,_),
                (0,_,_,2,_,_,_,2,2,_,_),
                (_,_,_,3,5,_,_,_,2,_,_),
                (1,_,2,2,_,_,1,_,_,_,1),
                (_,_,_,_,2,_,_,2,_,1,_),
                (_,1,0,_,_,2,_,_,_,0,_),
                (_,2,_,_,3,_,_,_,_,_,_),
                (_,1,_,_,3,_,2,_,0,_,_),
                (_,2,3,3,3,_,2,_,2,1,0),
                (0,_,_,_,_,2,2,_,_,_,_))
    elif n == 31:
        return ((1,_,_),
                (_,_,1),
                (_,_,2))
    elif n == 32:
        return ((_,_,_),
                (2,2,_),
                (1,2,_),
                (_,_,2))
    elif n == 33:
        return ((_,2,_,_,_,_,2,2,_,_,0,_,2,_,_),
                (1,1,_,_,2,2,_,2,_,2,_,_,_,2,_),
                (1,_,3,_,_,1,_,3,_,_,_,1,_,_,0),
                (_,_,_,1,_,_,3,_,_,_,1,0,0,_,_))
    elif n == 34:
        return ((_,_,1,_,2,_,_,_,1,_,0,1,_,1),
                (_,_,_,_,_,2,_,_,_,_,_,_,2,2),
                (_,3,_,_,_,_,3,_,_,3,_,_,_,_),
                (_,_,_,1,1,_,4,_,_,3,_,2,2,_),
                (3,_,2,_,0,1,_,_,_,_,_,_,_,_),
                (_,2,_,1,_,_,2,_,_,0,_,2,2,2),
                (_,_,_,2,0,_,_,_,0,_,_,_,1,_),
                (_,_,_,_,1,_,1,_,1,_,_,_,_,3),
                (_,3,_,_,_,_,_,_,_,_,_,_,_,_),
                (0,_,_,4,_,_,2,_,3,3,4,3,_,_),
                (_,_,_,_,_,_,_,_,_,_,2,_,_,_),
                (0,1,2,_,_,_,2,_,_,_,_,_,1,2),
                (_,1,_,1,_,2,1,3,_,_,_,2,_,2),
                (_,_,1,_,_,1,0,_,1,_,2,_,_,_))
    elif n == 35:
        return ((_,1,_,_,_,_,_,0,_,_,_,_),
                (_,_,_,_,_,_,1,1,_,_,1,_),
                (2,3,5,3,_,1,_,_,3,_,_,2),
                (1,_,_,_,_,3,_,1,2,_,_,_),
                (_,_,_,_,_,_,_,1,2,_,2,_),
                (0,_,1,2,_,_,_,_,_,_,2,_),
                (_,2,1,1,1,_,2,_,_,1,2,1),
                (_,4,_,_,_,3,4,2,_,_,2,_),
                (_,3,_,_,_,_,_,_,_,1,_,1),
                (_,_,1,_,3,_,_,_,_,2,3,2),
                (_,1,2,_,_,_,_,_,_,_,2,0),
                (_,_,_,_,3,2,1,2,1,_,_,_))
    elif n == 36:
        return ((_,0,_,_,_,0,_,1),
                (_,1,_,1,0,1,_,_),
                (_,1,_,_,_,_,_,_),
                (_,_,_,3,_,_,_,_),
                (1,_,_,_,_,2,_,_),
                (_,_,2,4,_,1,2,2),
                (_,_,_,2,_,_,4,_),
                (1,2,_,2,_,_,_,_))
    elif n == 37:
        return ((_,1,_,1,1,1,_,_,_,_),
                (_,_,_,3,2,_,_,1,_,_),
                (_,_,_,_,_,1,1,_,3,_),
                (3,3,_,_,_,3,_,_,_,_),
                (_,2,2,_,_,_,_,2,3,_),
                (_,3,_,3,_,_,3,_,1,2),
                (_,2,_,2,_,_,_,_,_,1),
                (_,4,_,3,_,2,_,2,_,_),
                (_,_,_,2,2,_,_,_,_,1),
                (_,_,_,_,1,_,_,_,_,0))
    elif n == 38:
        return ((_,_,2,_,1,1,_,_,0,_),
                (0,_,_,3,3,_,1,_,_,0),
                (_,2,_,2,_,_,_,2,1,1),
                (_,_,_,_,2,_,_,2,2,_),
                (0,2,_,_,1,1,_,_,2,1),
                (1,_,_,_,_,1,_,_,_,_),
                (_,3,_,_,_,_,_,_,_,_),
                (_,_,_,_,1,1,_,1,_,_),
                (_,3,3,_,3,_,_,1,_,1),
                (_,_,_,_,2,1,_,_,2,1))
    elif n == 39:
        return ((_,1,2,2,_,_,_,_,_,0),
                (_,_,3,5,_,_,1,2,_,1),
                (_,_,3,_,_,_,_,3,2,_),
                (_,_,_,3,_,1,1,_,2,_),
                (_,2,_,_,1,_,_,_,1,_),
                (_,_,2,_,_,_,_,_,2,0),
                (1,3,3,3,_,3,_,_,_,1),
                (1,_,_,_,_,_,_,3,_,_),
                (1,_,_,2,_,_,_,2,_,1),
                (1,_,_,0,1,_,_,1,_,_))
    elif n == 40:
        return ((_,0,0,_,_,_,1,_,_,2,_,2,1,_,_,0,0,_,0,_),
                (_,_,_,0,_,_,_,1,_,_,_,2,_,_,1,1,_,_,_,2),
                (1,_,0,_,0,1,_,_,0,_,_,_,1,_,_,_,_,2,_,_),
                (_,_,_,0,_,0,_,_,_,1,1,_,0,_,_,_,1,_,2,_),
                (_,_,_,_,_,_,1,_,_,1,_,1,_,_,1,_,_,0,_,_),
                (_,0,_,_,2,_,_,_,_,_,_,_,1,_,_,2,1,_,2,_),
                (0,_,_,1,_,_,_,_,4,2,_,0,_,_,_,_,2,1,3,_),
                (0,_,_,_,_,3,_,1,_,0,_,0,_,_,_,_,_,_,_,1),
                (_,_,_,0,1,_,_,_,2,1,_,_,_,1,_,_,3,_,_,0),
                (1,_,1,_,_,_,_,_,_,_,_,_,_,1,_,_,_,_,1,_),
                (_,_,_,2,_,2,_,2,_,_,1,_,0,_,1,2,_,_,_,_),
                (1,2,_,3,_,2,_,_,_,_,_,_,_,1,_,_,_,0,_,_),
                (_,_,_,2,2,_,_,_,_,1,_,_,_,_,_,_,2,_,0,_),
                (_,_,3,2,_,1,_,_,1,1,2,_,_,_,2,_,_,_,0,_),
                (_,2,3,_,_,3,_,_,_,1,_,_,_,_,2,1,_,_,_,0),
                (_,_,_,_,0,_,_,1,_,_,_,_,_,2,1,_,_,_,_,_),
                (1,_,_,1,_,3,3,2,_,_,_,1,_,1,_,_,_,1,_,1),
                (_,1,_,1,1,_,_,_,3,_,_,_,1,_,2,_,0,0,_,_),
                (2,_,_,_,_,_,2,_,_,_,_,2,1,_,_,_,_,_,_,1),
                (_,_,_,_,1,_,0,0,_,_,_,_,_,_,_,1,_,1,_,_))
    elif n == 41:
        return ((_,_,_,_,_,_,_,_,_,_,2,_,_,1,2,_,0,_,_),
                (0,_,_,2,_,3,1,_,_,_,_,_,2,_,_,1,1,1,_),
                (_,1,_,1,_,_,2,_,0,_,_,1,_,_,2,_,_,_,_),
                (_,_,1,2,_,2,0,1,_,_,_,_,2,_,2,_,_,_,3),
                (2,_,2,_,2,_,_,_,_,1,_,_,0,2,_,_,_,1,_),
                (_,1,_,_,_,_,0,_,_,_,1,_,1,_,_,2,_,1,_),
                (_,_,_,3,1,0,_,_,2,_,1,_,_,_,_,1,_,_,_),
                (_,_,3,_,_,_,_,2,2,_,_,_,_,1,2,_,2,2,_),
                (_,2,2,_,_,_,_,_,1,1,2,_,_,_,_,_,_,2,2),
                (_,_,_,1,0,_,2,_,_,_,1,1,_,_,_,0,1,_,1),
                (1,_,_,_,1,_,_,1,_,_,_,0,1,_,_,_,1,_,_),
                (2,3,_,_,1,0,_,0,_,_,_,_,_,_,1,_,_,_,_),
                (_,_,_,3,_,_,_,1,_,_,_,_,_,0,1,_,_,1,_),
                (1,_,_,1,_,_,_,_,1,1,3,_,_,_,1,_,_,0,_),
                (_,0,_,2,2,_,_,_,_,1,_,_,_,_,_,_,_,0,_),
                (_,1,_,_,_,_,_,_,2,2,_,_,_,2,_,_,_,2,_),
                (0,_,1,1,1,1,_,_,2,_,_,_,2,_,_,_,_,_,2),
                (_,_,_,_,1,1,1,_,_,2,_,_,_,_,0,1,_,2,_),
                (_,1,0,0,_,_,_,1,_,_,0,0,_,_,_,_,_,_,_))
    elif n == 42:
        return ((_,1,_,_,1,_,_,_,_,_,_,0,_,0,_,_,_,_,_,2),
                (3,_,_,_,_,_,1,1,2,_,_,0,_,0,2,_,_,2,_,1),
                (2,_,2,_,_,2,_,2,2,_,_,1,_,_,_,_,_,3,_,_),
                (_,_,2,_,2,_,_,_,1,_,_,_,0,_,_,_,2,_,1,_),
                (_,_,2,_,3,_,_,0,0,_,_,_,0,_,_,_,_,4,_,_),
                (2,_,_,3,_,_,_,_,2,_,_,0,_,2,_,_,_,_,_,1),
                (2,2,2,_,_,_,_,_,_,_,_,_,2,_,_,1,_,_,_,1),
                (1,_,1,_,_,0,2,_,4,_,_,_,_,1,_,_,_,_,_,_),
                (1,_,2,_,_,_,_,_,2,1,_,_,3,_,_,_,1,_,_,1),
                (1,_,_,1,_,_,_,1,_,_,_,_,2,_,2,1,0,1,0,_))
    elif n == 43:
        return ((1,_,_),
                (_,_,2),
                (_,0,_))
    elif n == 44:
        return ((_,_,_,0,_,0,0,_,_,0),
                (1,_,1,_,_,_,_,_,_,2),
                (_,0,_,_,2,2,_,0,1,_))
    elif n == 45:
        return ((A,2,A,2,A,2,2,1,2,1),
                (2,4,2,3,2,A,2,A,2,A),
                (A,2,A,1,2,2,4,2,4,2),
                (2,4,2,3,2,A,2,A,2,A),
                (A,2,A,2,A,2,2,1,2,1))
    elif n == 46:
        return ((A,_,A,_,A,_,_,_,_,_),
                (_,_,_,_,_,A,_,A,_,A),
                (A,_,A,_,_,_,_,_,_,_),
                (_,_,_,_,_,A,_,A,_,A),
                (A,_,A,_,A,_,_,_,_,_))
    elif n == 47:
        return ((_,A,_,A,_,_,_,_,_,A),
                (_,_,_,_,A,_,A,_,A,_),
                (_,A,_,_,_,_,_,_,_,_),
                (_,_,_,_,A,_,A,_,A,_),
                (_,A,_,A,_,_,_,_,_,A))
    elif n == 48:
        return ((2,1,1,_),
                (_,_,_,1),
                (_,_,2,_),
                (3,_,_,_))
    elif n == 49:
        return ((_,2,_,_,_),
                (_,2,_,_,_),
                (0,_,2,3,2),
                (_,_,1,_,_),
                (_,1,1,_,3))
    elif n == 50:
        return ((_,0,_,_),
                (1,_,2,2),
                (_,_,1,_),
                (1,1,_,_))
    elif n == 51:
        return((_,_,_,_,3),
               (_,_,1,_,2),
               (_,1,_,_,1),
               (_,0,0,_,_))
    else:
        raise ValueError('index out of bound')
                
def check_grid(grid: Sequence[Sequence[Optional[int]]]) -> None:
    """Perform sanity check on input grid."""
    nrow = len(grid)
    if nrow == 0:
        raise RuntimeError('Empty grid!')
    ncol = len(grid[0])
    for row in grid:
        if len(row) != ncol:
            raise RuntimeError('Non-rectangular grid!')

if __name__ == '__main__':

    args = parse_command()

    try:
        grid = get_grid(args.puzzle)
        check_grid(grid)
    except Exception as err:
        raise SystemExit(err)
